"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var SQLite = /** @class */ (function (_super) {
    __extends(SQLite, _super);
    /**
     *
     * @param executor Executor function for Promise
     */
    function SQLite(executor) {
        var _this = _super.call(this, function (resolve, reject) {
            _this._isOpen = false;
            _this._resultType = SQLite.RESULTSASARRAY;
            _this._valuesType = SQLite.VALUESARENATIVE;
            return new Promise(executor);
        }) || this;
        /***
         * Constant that this structure is a sqlite structure
         * @type {boolean}
         */
        _this._isSqlite = true;
        return _this;
    }
    /***
     * This gets or sets the database version
     * @param ver to set or underfined to get version
     * @returns Promise<any>
     */
    SQLite.prototype.version = function (ver) {
        if (ver !== undefined) {
            return this.execSQL('PRAGMA user_version=' + (ver).toString());
        }
        else {
            return this.get('PRAGMA user_version', SQLite.RESULTSASARRAY).then(function (data) {
                return (data && data[0]);
            });
        }
    };
    ;
    /***
     * Is the database currently open
     * @returns {boolean} - true if the db is open
     */
    SQLite.prototype.isOpen = function () {
        return this._isOpen;
    };
    ;
    /***
     * Converts a Mixed Array to a String Array
     * @param params
     * @returns {Array}
     * @private
     */
    SQLite.prototype._toStringArray = function (params) {
        var stringParams = [];
        if (Object.prototype.toString.apply(params) === '[object Array]') {
            var count = params.length;
            for (var i = 0; i < count; ++i) {
                if (params[i] == null) {
                    stringParams.push(null);
                }
                else {
                    stringParams.push(params[i].toString());
                }
            }
        }
        else {
            if (params == null) {
                stringParams.push(null);
            }
            else {
                stringParams.push(params.toString());
            }
        }
        return stringParams;
    };
    ;
    /***
     * Is this a SQLite object
     * @param obj - possible sqlite object to check
     * @returns {boolean}
     */
    SQLite.isSqlite = function (obj) {
        return obj && obj._isSqlite;
    };
    ;
    // Literal Defines
    SQLite.RESULTSASARRAY = 1;
    SQLite.RESULTSASOBJECT = 2;
    SQLite.VALUESARENATIVE = 4;
    SQLite.VALUESARESTRINGS = 8;
    return SQLite;
}(Promise));
exports.SQLite = SQLite;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3FsaXRlLWNvbW1vbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInNxbGl0ZS1jb21tb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFpRUE7SUFBcUMsMEJBQWtCO0lBa0JuRDs7O09BR0c7SUFDSCxnQkFBbUIsUUFBc0Q7UUFBekUsWUFDSSxrQkFBTSxVQUFDLE9BQU8sRUFBRSxNQUFNO1lBRWxCLEtBQUksQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO1lBQ3JCLEtBQUksQ0FBQyxXQUFXLEdBQUcsTUFBTSxDQUFDLGNBQWMsQ0FBQztZQUN6QyxLQUFJLENBQUMsV0FBVyxHQUFHLE1BQU0sQ0FBQyxlQUFlLENBQUM7WUFFMUMsTUFBTSxDQUFDLElBQUksT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2pDLENBQUMsQ0FBQyxTQUNMO1FBbkJEOzs7V0FHRztRQUNILGVBQVMsR0FBWSxJQUFJLENBQUM7O0lBZTFCLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksd0JBQU8sR0FBZCxVQUFlLEdBQXFCO1FBQ2hDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDO1lBQ3BCLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLHNCQUFzQixHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztRQUNuRSxDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFDSixNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsRUFBRSxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQUMsSUFBSTtnQkFDcEUsTUFBTSxDQUFDLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzdCLENBQUMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQztJQUNMLENBQUM7SUFBQSxDQUFDO0lBR0Y7OztPQUdHO0lBQ0ksdUJBQU0sR0FBYjtRQUNJLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDO0lBQ3hCLENBQUM7SUFBQSxDQUFDO0lBeUNGOzs7OztPQUtHO0lBQ08sK0JBQWMsR0FBeEIsVUFBeUIsTUFBVztRQUNoQyxJQUFJLFlBQVksR0FBRyxFQUFFLENBQUM7UUFDdEIsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLGdCQUFnQixDQUFDLENBQUMsQ0FBQztZQUMvRCxJQUFJLEtBQUssR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDO1lBQzFCLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUM7Z0JBQzdCLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDO29CQUNwQixZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUM1QixDQUFDO2dCQUFDLElBQUksQ0FBQyxDQUFDO29CQUNKLFlBQVksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7Z0JBQzVDLENBQUM7WUFDTCxDQUFDO1FBQ0wsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ0osRUFBRSxDQUFDLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUM7Z0JBQ2pCLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDNUIsQ0FBQztZQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNKLFlBQVksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7WUFDekMsQ0FBQztRQUNMLENBQUM7UUFDRCxNQUFNLENBQUMsWUFBWSxDQUFDO0lBQ3hCLENBQUM7SUFBQSxDQUFDO0lBRUY7Ozs7T0FJRztJQUNXLGVBQVEsR0FBdEIsVUFBdUIsR0FBRztRQUN0QixNQUFNLENBQUMsR0FBRyxJQUFJLEdBQUcsQ0FBQyxTQUFTLENBQUM7SUFDaEMsQ0FBQztJQUFBLENBQUM7SUFoSUYsa0JBQWtCO0lBQ0sscUJBQWMsR0FBVyxDQUFDLENBQUM7SUFDM0Isc0JBQWUsR0FBVyxDQUFDLENBQUM7SUFDNUIsc0JBQWUsR0FBVyxDQUFDLENBQUM7SUFDNUIsdUJBQWdCLEdBQVcsQ0FBQyxDQUFDO0lBd0l4RCxhQUFDO0NBQUEsQUE5SUQsQ0FBcUMsT0FBTyxHQThJM0M7QUE5SXFCLHdCQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgYXBwIGZyb20gXCJ0bnMtY29yZS1tb2R1bGVzL2FwcGxpY2F0aW9uXCI7XG5pbXBvcnQgKiBhcyBwbGF0Zm9ybSBmcm9tIFwidG5zLWNvcmUtbW9kdWxlcy9wbGF0Zm9ybVwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIElEYXRhYmFzZSB7XG4gICAgdmVyc2lvbih2ZXI/OiBudW1iZXIgfCBzdHJpbmcpOiBQcm9taXNlPGFueT47XG5cblxuICAgIC8qKipcbiAgICAgKiBJcyB0aGUgZGF0YWJhc2UgY3VycmVudGx5IG9wZW5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSB0cnVlIGlmIHRoZSBkYiBpcyBvcGVuXG4gICAgICovXG4gICAgaXNPcGVuKCk7XG5cbiAgICAvKioqXG4gICAgICogR2V0cy9TZXRzIHdoZXRoZXIgeW91IGdldCBBcnJheXMgb3IgT2JqZWN0cyBmb3IgdGhlIHJvdyB2YWx1ZXNcbiAgICAgKiBAcGFyYW0gdmFsdWUgLSBEYXRhYmFzZS5SRVNVTFRTQVNBUlJBWSBvciBEYXRhYmFzZS5SRVNVTFRTQVNPQkpFQ1RcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAtIERhdGFiYXNlLlJFU1VMVFNBU0FSUkFZIG9yIERhdGFiYXNlLlJFU1VMVFNBU09CSkVDVFxuICAgICAqL1xuICAgIHJlc3VsdFR5cGUodmFsdWUpO1xuXG4gICAgLyoqKlxuICAgICAqIEdldHMvU2V0cyB3aGV0aGVyIHlvdSBnZXQgTmF0aXZlIG9yIFN0cmluZ3MgZm9yIHRoZSByb3cgdmFsdWVzXG4gICAgICogQHBhcmFtIHZhbHVlIC0gRGF0YWJhc2UuVkFMVUVTQVJFTkFUSVZFIG9yIERhdGFiYXNlLlZBTFVFU0FSRVNUUklOR1NcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAtIERhdGFiYXNlLlZBTFVFU0FSRU5BVElWRSBvciBEYXRhYmFzZS5WQUxVRVNBUkVTVFJJTkdTXG4gICAgICovXG4gICAgdmFsdWVUeXBlKHZhbHVlKTtcblxuICAgIC8qKipcbiAgICAgKiBDbG9zZXMgdGhpcyBkYXRhYmFzZSwgYW55IHF1ZXJpZXMgYWZ0ZXIgdGhpcyB3aWxsIGZhaWwgd2l0aCBhbiBlcnJvclxuICAgICAqIEBwYXJhbSBjYWxsYmFja1xuICAgICAqIEByZXR1cm5zIFByb21pc2VcbiAgICAgKi9cbiAgICBjbG9zZSgpOiBQcm9taXNlPGFueT47XG5cbiAgICAvKioqXG4gICAgICogRXhlYyBTUUxcbiAgICAgKiBAcGFyYW0gc3FsIC0gc3FsIHRvIHVzZVxuICAgICAqIEBwYXJhbSBwYXJhbXMgLSBvcHRpb25hbCBhcnJheSBvZiBwYXJhbWV0ZXJzXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIC0gKGVyciwgcmVzdWx0KSAtIGNhbiBiZSBsYXN0X3Jvd19pZCBmb3IgaW5zZXJ0LCBhbmQgcm93cyBhZmZlY3RlZCBmb3IgdXBkYXRlL2RlbGV0ZVxuICAgICAqIEByZXR1cm5zIFByb21pc2VcbiAgICAgKi9cbiAgICBleGVjU1FMKHNxbDogc3RyaW5nLCBwYXJhbXM/OiBzdHJpbmdbXSk6IFByb21pc2U8YW55PjtcblxuICAgIC8qKipcbiAgICAgKiBHZXQgdGhlIGZpcnN0IHJlY29yZCByZXN1bHQgc2V0XG4gICAgICogQHBhcmFtIHNxbCAtIHNxbCB0byBydW5cbiAgICAgKiBAcGFyYW0gcGFyYW1zIC0gb3B0aW9uYWxcbiAgICAgKiBAcGFyYW0gbW9kZSAtIGFsbG93cyB5b3UgdG8gbWFudWFsbHkgb3ZlcnJpZGUgdGhlIHJlc3VsdHMgc2V0IHRvIGJlIGEgYXJyYXkgb3Igb2JqZWN0XG4gICAgICogQHJldHVybnMgUHJvbWlzZVxuICAgICAqL1xuICAgIGdldChzcWw6IHN0cmluZywgcGFyYW1zPzogYW55LCBtb2RlPzogbnVtYmVyKTogUHJvbWlzZTxhbnk+O1xuXG5cblxuICAgIC8qKipcbiAgICAgKiBUaGlzIHJldHVybnMgdGhlIGVudGlyZSByZXN1bHQgc2V0IGluIGEgYXJyYXkgb2Ygcm93c1xuICAgICAqIEBwYXJhbSBzcWwgLSBTcWwgdG8gcnVuXG4gICAgICogQHBhcmFtIHBhcmFtcyAtIG9wdGlvbmFsIFxuXG4gICAgICogQHJldHVybnMgUHJvbWlzZVxuICAgICAqL1xuICAgIGFsbChzcWw6IHN0cmluZywgcGFyYW1zPzogYW55KVxuXG59XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBTUUxpdGUgZXh0ZW5kcyBQcm9taXNlPElEYXRhYmFzZT4gaW1wbGVtZW50cyBJRGF0YWJhc2Uge1xuXG4gICAgLy8gTGl0ZXJhbCBEZWZpbmVzXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBSRVNVTFRTQVNBUlJBWTogbnVtYmVyID0gMTtcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFJFU1VMVFNBU09CSkVDVDogbnVtYmVyID0gMjtcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFZBTFVFU0FSRU5BVElWRTogbnVtYmVyID0gNDtcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFZBTFVFU0FSRVNUUklOR1M6IG51bWJlciA9IDg7XG5cbiAgICBwcm90ZWN0ZWQgX2lzT3BlbjogYm9vbGVhbjtcbiAgICBwcm90ZWN0ZWQgX3Jlc3VsdFR5cGU6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgX3ZhbHVlc1R5cGU6IG51bWJlcjtcblxuICAgIC8qKipcbiAgICAgKiBDb25zdGFudCB0aGF0IHRoaXMgc3RydWN0dXJlIGlzIGEgc3FsaXRlIHN0cnVjdHVyZVxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIF9pc1NxbGl0ZTogYm9vbGVhbiA9IHRydWU7XG5cbiAgICAvKipcbiAgICAgKiAgXG4gICAgICogQHBhcmFtIGV4ZWN1dG9yIEV4ZWN1dG9yIGZ1bmN0aW9uIGZvciBQcm9taXNlXG4gICAgICovXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKGV4ZWN1dG9yOiAocmVzb2x2ZTogRnVuY3Rpb24sIHJlamVjdDogRnVuY3Rpb24pID0+IGFueSkge1xuICAgICAgICBzdXBlcigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cbiAgICAgICAgICAgIHRoaXMuX2lzT3BlbiA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fcmVzdWx0VHlwZSA9IFNRTGl0ZS5SRVNVTFRTQVNBUlJBWTtcbiAgICAgICAgICAgIHRoaXMuX3ZhbHVlc1R5cGUgPSBTUUxpdGUuVkFMVUVTQVJFTkFUSVZFO1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZXhlY3V0b3IpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKioqXG4gICAgICogVGhpcyBnZXRzIG9yIHNldHMgdGhlIGRhdGFiYXNlIHZlcnNpb25cbiAgICAgKiBAcGFyYW0gdmVyIHRvIHNldCBvciB1bmRlcmZpbmVkIHRvIGdldCB2ZXJzaW9uXG4gICAgICogQHJldHVybnMgUHJvbWlzZTxhbnk+XG4gICAgICovXG4gICAgcHVibGljIHZlcnNpb24odmVyPzogbnVtYmVyIHwgc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgICAgICAgaWYgKHZlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5leGVjU1FMKCdQUkFHTUEgdXNlcl92ZXJzaW9uPScgKyAodmVyKS50b1N0cmluZygpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldCgnUFJBR01BIHVzZXJfdmVyc2lvbicsIFNRTGl0ZS5SRVNVTFRTQVNBUlJBWSkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiAoZGF0YSAmJiBkYXRhWzBdKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcblxuXG4gICAgLyoqKlxuICAgICAqIElzIHRoZSBkYXRhYmFzZSBjdXJyZW50bHkgb3BlblxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIHRydWUgaWYgdGhlIGRiIGlzIG9wZW5cbiAgICAgKi9cbiAgICBwdWJsaWMgaXNPcGVuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faXNPcGVuO1xuICAgIH07XG5cbiAgICAvKioqXG4gICAgICogR2V0cy9TZXRzIHdoZXRoZXIgeW91IGdldCBBcnJheXMgb3IgT2JqZWN0cyBmb3IgdGhlIHJvdyB2YWx1ZXNcbiAgICAgKiBAcGFyYW0gdmFsdWUgLSBEYXRhYmFzZS5SRVNVTFRTQVNBUlJBWSBvciBEYXRhYmFzZS5SRVNVTFRTQVNPQkpFQ1RcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAtIERhdGFiYXNlLlJFU1VMVFNBU0FSUkFZIG9yIERhdGFiYXNlLlJFU1VMVFNBU09CSkVDVFxuICAgICAqL1xuICAgIHB1YmxpYyBhYnN0cmFjdCByZXN1bHRUeXBlKHZhbHVlKTtcblxuICAgIC8qKipcbiAgICAgKiBHZXRzL1NldHMgd2hldGhlciB5b3UgZ2V0IE5hdGl2ZSBvciBTdHJpbmdzIGZvciB0aGUgcm93IHZhbHVlc1xuICAgICAqIEBwYXJhbSB2YWx1ZSAtIERhdGFiYXNlLlZBTFVFU0FSRU5BVElWRSBvciBEYXRhYmFzZS5WQUxVRVNBUkVTVFJJTkdTXG4gICAgICogQHJldHVybnMge251bWJlcn0gLSBEYXRhYmFzZS5WQUxVRVNBUkVOQVRJVkUgb3IgRGF0YWJhc2UuVkFMVUVTQVJFU1RSSU5HU1xuICAgICAqL1xuICAgIHB1YmxpYyBhYnN0cmFjdCB2YWx1ZVR5cGUodmFsdWUpO1xuXG4gICAgLyoqKlxuICAgICAqIENsb3NlcyB0aGlzIGRhdGFiYXNlLCBhbnkgcXVlcmllcyBhZnRlciB0aGlzIHdpbGwgZmFpbCB3aXRoIGFuIGVycm9yXG4gICAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAgICogQHJldHVybnMgUHJvbWlzZVxuICAgICAqL1xuICAgIHB1YmxpYyBhYnN0cmFjdCBjbG9zZSgpOiBQcm9taXNlPGFueT47XG5cbiAgICAvKioqXG4gICAgICogRXhlYyBTUUxcbiAgICAgKiBAcGFyYW0gc3FsIC0gc3FsIHRvIHVzZVxuICAgICAqIEBwYXJhbSBwYXJhbXMgLSBvcHRpb25hbCBhcnJheSBvZiBwYXJhbWV0ZXJzXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIC0gKGVyciwgcmVzdWx0KSAtIGNhbiBiZSBsYXN0X3Jvd19pZCBmb3IgaW5zZXJ0LCBhbmQgcm93cyBhZmZlY3RlZCBmb3IgdXBkYXRlL2RlbGV0ZVxuICAgICAqIEByZXR1cm5zIFByb21pc2VcbiAgICAgKi9cbiAgICBwdWJsaWMgYWJzdHJhY3QgZXhlY1NRTChzcWw6IHN0cmluZywgcGFyYW1zPzogc3RyaW5nW10pOiBQcm9taXNlPGFueT47XG5cbiAgICAvKioqXG4gICAgICogR2V0IHRoZSBmaXJzdCByZWNvcmQgcmVzdWx0IHNldFxuICAgICAqIEBwYXJhbSBzcWwgLSBzcWwgdG8gcnVuXG4gICAgICogQHBhcmFtIHBhcmFtcyAtIG9wdGlvbmFsXG4gICAgICogQHBhcmFtIG1vZGUgLSBhbGxvd3MgeW91IHRvIG1hbnVhbGx5IG92ZXJyaWRlIHRoZSByZXN1bHRzIHNldCB0byBiZSBhIGFycmF5IG9yIG9iamVjdFxuICAgICAqIEByZXR1cm5zIFByb21pc2VcbiAgICAgKi9cbiAgICBwdWJsaWMgYWJzdHJhY3QgZ2V0KHNxbDogc3RyaW5nLCBwYXJhbXM/OiBhbnksIG1vZGU/OiBudW1iZXIpOiBQcm9taXNlPGFueT47XG5cbiAgICAvKioqXG4gICAgICogQ29udmVydHMgYSBNaXhlZCBBcnJheSB0byBhIFN0cmluZyBBcnJheVxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgX3RvU3RyaW5nQXJyYXkocGFyYW1zOiBhbnkpIHtcbiAgICAgICAgdmFyIHN0cmluZ1BhcmFtcyA9IFtdO1xuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5hcHBseShwYXJhbXMpID09PSAnW29iamVjdCBBcnJheV0nKSB7XG4gICAgICAgICAgICB2YXIgY291bnQgPSBwYXJhbXMubGVuZ3RoO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmFtc1tpXSA9PSBudWxsKSB7IC8vIGpzaGludCBpZ25vcmU6bGluZVxuICAgICAgICAgICAgICAgICAgICBzdHJpbmdQYXJhbXMucHVzaChudWxsKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdHJpbmdQYXJhbXMucHVzaChwYXJhbXNbaV0udG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHBhcmFtcyA9PSBudWxsKSB7IC8vIGpzaGludCBpZ25vcmU6bGluZVxuICAgICAgICAgICAgICAgIHN0cmluZ1BhcmFtcy5wdXNoKG51bGwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdHJpbmdQYXJhbXMucHVzaChwYXJhbXMudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0cmluZ1BhcmFtcztcbiAgICB9O1xuXG4gICAgLyoqKlxuICAgICAqIElzIHRoaXMgYSBTUUxpdGUgb2JqZWN0XG4gICAgICogQHBhcmFtIG9iaiAtIHBvc3NpYmxlIHNxbGl0ZSBvYmplY3QgdG8gY2hlY2tcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIGlzU3FsaXRlKG9iaikge1xuICAgICAgICByZXR1cm4gb2JqICYmIG9iai5faXNTcWxpdGU7XG4gICAgfTtcblxuXG4gICAgLyoqKlxuICAgICAqIFRoaXMgcmV0dXJucyB0aGUgZW50aXJlIHJlc3VsdCBzZXQgaW4gYSBhcnJheSBvZiByb3dzXG4gICAgICogQHBhcmFtIHNxbCAtIFNxbCB0byBydW5cbiAgICAgKiBAcGFyYW0gcGFyYW1zIC0gb3B0aW9uYWwgXG5cbiAgICAgKiBAcmV0dXJucyBQcm9taXNlXG4gICAgICovXG4gICAgcHVibGljIGFic3RyYWN0IGFsbChzcWw6IFN0cmluZywgcGFyYW1zPzogc3RyaW5nW10pO1xuXG59Il19